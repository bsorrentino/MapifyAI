!function(e,t,s,r,i){var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o="function"==typeof a[r]&&a[r],d=o.cache||{},n="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function l(t,s){if(!d[t]){if(!e[t]){var i="function"==typeof a[r]&&a[r];if(!s&&i)return i(t,!0);if(o)return o(t,!0);if(n&&"string"==typeof t)return n(t);var c=Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}u.resolve=function(s){var r=e[t][1][s];return null!=r?r:s},u.cache={};var p=d[t]=new l.Module(t);e[t][0].call(p.exports,u,p,p.exports,a)}return d[t].exports;function u(e){var t=u.resolve(e);return!1===t?{}:l(t)}}l.isParcelRequire=!0,l.Module=function(e){this.id=e,this.bundle=l,this.exports={}},l.modules=e,l.cache=d,l.parent=o,l.register=function(t,s){e[t]=[function(e,t){t.exports=s},{}]},Object.defineProperty(l,"root",{get:function(){return a[r]}}),a[r]=l;for(var c=0;c<t.length;c++)l(t[c])}({f8gmr:[function(e,t,s,r){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(s),i.export(s,"diagram",()=>P);var a=e("./styles-6aaf32cf.js"),o=e("dagre-d3-es/src/graphlib/index.js"),d=e("d3"),n=e("./mermaid-b5860b54.js"),l=e("./index-3862675e.js");e("ts-dedent"),e("dayjs"),e("@braintree/sanitize-url"),e("dompurify"),e("khroma"),e("lodash-es/memoize.js"),e("lodash-es/merge.js"),e("stylis"),e("lodash-es/isEmpty.js"),e("dagre-d3-es/src/dagre/index.js"),e("dagre-d3-es/src/graphlib/json.js"),e("./edges-e0da2a9e.js"),e("./createText-2e5e7dd3.js"),e("mdast-util-from-markdown");let c="rect",p="rectWithTitle",u="statediagram",g=`${u}-state`,f="transition",b=`${f} note-edge`,h=`${u}-note`,y=`${u}-cluster`,m=`${u}-cluster-alt`,x="parent",j="note",w="----",T=`${w}${j}`,$=`${w}${x}`,v="fill:none",k="fill: #333",S="text",D="normal",A={},E=0;function N(e="",t=0,s="",r=w){let i=null!==s&&s.length>0?`${r}${s}`:"";return`state-${e}${i}-${t}`}let z=(e,t,s,r,i,o)=>{var d;let l=s.id,u=null==(d=r[l])?"":d.classes?d.classes.join(" "):"";if("root"!==l){let t=c;!0===s.start&&(t="start"),!1===s.start&&(t="end"),s.type!==a.D&&(t=s.type),A[l]||(A[l]={id:l,shape:t,description:(0,n.e).sanitizeText(l,(0,n.c)()),classes:`${u} ${g}`});let r=A[l];s.description&&(Array.isArray(r.description)?(r.shape=p,r.description.push(s.description)):r.description.length>0?(r.shape=p,r.description===l?r.description=[s.description]:r.description=[r.description,s.description]):(r.shape=c,r.description=s.description),r.description=(0,n.e).sanitizeTextOrArray(r.description,(0,n.c)())),1===r.description.length&&r.shape===p&&(r.shape=c),!r.type&&s.doc&&((0,n.l).info("Setting cluster for ",l,B(s)),r.type="group",r.dir=B(s),r.shape=s.type===a.a?"divider":"roundedWithTitle",r.classes=r.classes+" "+y+" "+(o?m:""));let i={labelStyle:"",shape:r.shape,labelText:r.description,classes:r.classes,style:"",id:l,dir:r.dir,domId:N(l,E),type:r.type,padding:15};if(i.centerLabel=!0,s.note){let t={labelStyle:"",shape:"note",labelText:s.note.text,classes:h,style:"",id:l+T+"-"+E,domId:N(l,E,j),type:r.type,padding:15},a={labelStyle:"",shape:"noteGroup",labelText:s.note.text,classes:r.classes,style:"",id:l+$,domId:N(l,E,x),type:"group",padding:0};E++;let o=l+$;e.setNode(o,a),e.setNode(t.id,t),e.setNode(l,i),e.setParent(l,o),e.setParent(t.id,o);let d=l,n=t.id;"left of"===s.note.position&&(d=t.id,n=l),e.setEdge(d,n,{arrowhead:"none",arrowType:"",style:v,labelStyle:"",classes:b,arrowheadStyle:k,labelpos:"c",labelType:S,thickness:D})}else e.setNode(l,i)}t&&"root"!==t.id&&((0,n.l).trace("Setting node ",l," to be child of its parent ",t.id),e.setParent(l,t.id)),s.doc&&((0,n.l).trace("Adding nodes children "),O(e,s,s.doc,r,i,!o))},O=(e,t,s,r,i,o)=>{(0,n.l).trace("items",s),s.forEach(s=>{switch(s.stmt){case a.b:case a.D:z(e,t,s,r,i,o);break;case a.S:{z(e,t,s.state1,r,i,o),z(e,t,s.state2,r,i,o);let a={id:"edge"+E,arrowhead:"normal",arrowTypeEnd:"arrow_barb",style:v,labelStyle:"",label:(0,n.e).sanitizeText(s.description,(0,n.c)()),arrowheadStyle:k,labelpos:"c",labelType:S,thickness:D,classes:f};e.setEdge(s.state1.id,s.state2.id,a,E),E++}}})},B=(e,t=a.c)=>{let s=t;if(e.doc)for(let t=0;t<e.doc.length;t++){let r=e.doc[t];"dir"===r.stmt&&(s=r.value)}return s},M=async function(e,t,s,r){let i;(0,n.l).info("Drawing state diagram (v2)",t),A={},r.db.getDirection();let{securityLevel:a,state:p}=(0,n.c)(),g=p.nodeSpacing||50,f=p.rankSpacing||50;(0,n.l).info(r.db.getRootDocV2()),r.db.extract(r.db.getRootDocV2()),(0,n.l).info(r.db.getRootDocV2());let b=r.db.getStates(),h=new o.Graph({multigraph:!0,compound:!0}).setGraph({rankdir:B(r.db.getRootDocV2()),nodesep:g,ranksep:f,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}});z(h,void 0,r.db.getRootDocV2(),b,r.db,!0),"sandbox"===a&&(i=(0,d.select)("#i"+t));let y="sandbox"===a?(0,d.select)(i.nodes()[0].contentDocument.body):(0,d.select)("body"),m=y.select(`[id="${t}"]`),x=y.select("#"+t+" g");await (0,l.r)(x,h,["barb"],u,t),(0,n.u).insertTitle(m,"statediagramTitleText",p.titleTopMargin,r.db.getDiagramTitle());let j=m.node().getBBox(),w=j.width+16,T=j.height+16;m.attr("class",u);let $=m.node().getBBox();(0,n.i)(m,T,w,p.useMaxWidth);let v=`${$.x-8} ${$.y-8} ${w} ${T}`;for(let e of((0,n.l).debug(`viewBox ${v}`),m.attr("viewBox",v),document.querySelectorAll('[id="'+t+'"] .edgeLabel .label'))){let t=e.getBBox(),s=document.createElementNS("http://www.w3.org/2000/svg",c);s.setAttribute("rx",0),s.setAttribute("ry",0),s.setAttribute("width",t.width),s.setAttribute("height",t.height),e.insertBefore(s,e.firstChild)}},P={parser:a.p,db:a.d,renderer:{setConf:function(e){for(let t of Object.keys(e))e[t]},getClasses:function(e,t){return t.db.extract(t.db.getRootDocV2()),t.db.getClasses()},draw:M},styles:a.s,init:e=>{e.state||(e.state={}),e.state.arrowMarkerAbsolute=e.arrowMarkerAbsolute,(0,a.d).clear()}}},{"./styles-6aaf32cf.js":"gNw0p","dagre-d3-es/src/graphlib/index.js":"j6NXy",d3:"ahWNw","./mermaid-b5860b54.js":"2omMO","./index-3862675e.js":"8RdUO","ts-dedent":"azOLv",dayjs:"8F3kd","@braintree/sanitize-url":"eIPUt",dompurify:"5cPaM",khroma:"kb6Zw","lodash-es/memoize.js":"kSZfU","lodash-es/merge.js":"ije1P",stylis:"lfeQC","lodash-es/isEmpty.js":"941eg","dagre-d3-es/src/dagre/index.js":"9xp7T","dagre-d3-es/src/graphlib/json.js":"5pdrN","./edges-e0da2a9e.js":"3cEzO","./createText-2e5e7dd3.js":"3A2vP","mdast-util-from-markdown":"i9FLz","@parcel/transformer-js/src/esmodule-helpers.js":"k3151"}]},[],0,"parcelRequire94c2");
//# sourceMappingURL=stateDiagram-v2-d93cdb3a.08ec36eb.js.map
